"use strict";angular.module("postManagerApp",["ngRoute"]).constant("POSTSERVICEURL","http://jsonplaceholder.typicode.com/posts/").run(["$route","$rootScope","$location",function(){}]).config(["$routeProvider",function(t){t.when("/",{templateUrl:"app/views/pages/list/list.html",controller:"listCtrl",resolve:{listPosts:["PostsService","POSTSERVICEURL",function(t,e){return t.listPosts(e)}]}}).when("/posts/create",{templateUrl:"app/views/pages/create/create.html",controller:"createCtrl"}).when("/posts/edit/:id/",{templateUrl:"app/views/pages/edit/edit.html",controller:"editCtrl"}).otherwise({redirectTo:"/"})}]),angular.module("postManagerApp").controller("listCtrl",["$rootScope","$scope","PostsService","AlertService","listPosts","$timeout",function(t,e,o,r,n,s){var i;e.post={},e["delete"]=function(t){i=t,r.confirmMessage("Are you sure you want to delete the post?")};var a=function(){e.listPosts=o.getPosts()},c=function(){e.listPosts=n,t.$on("removePost",function(){o.removePost(i).then(function(){s(function(){r.alertMessage("Post removed successfully")},500)}),a()})};c()}]),angular.module("postManagerApp").controller("createCtrl",["$rootScope","$scope","PostsService","$location","AlertService",function(t,e,o,r,n){e.submitform=!1,e.save=function(s){e.submitform=!0,n.alertMessage("Post is submitting..."),o.savePost(s).then(function(){r.path("/",!1),n.alertMessage("Post submitted successfully"),t.$emit("updatePost")})};var s=function(){e.post={title:"",body:""}},i=function(){0==o.getPosts().length?r.path("/",!1):s()};i()}]),angular.module("postManagerApp").controller("editCtrl",["$rootScope","$scope","$routeParams","PostsService","AlertService","$location","$filter",function(t,e,o,r,n,s,i){e.submitform=!1,e.save=function(o){e.submitform=!0,n.alertMessage("Post is updating..."),r.savePost(o).then(function(){s.path("/",!1),n.alertMessage("Post updated successfully"),t.$emit("updatePost")})};var a=function(){if(0==r.getPosts().length)s.path("/",!1);else{var t=o.id;e.post=i("filter")(r.getPosts(),{id:t})[0]}};a()}]),angular.module("postManagerApp").factory("PostsService",["$rootScope","$http","$q","POSTSERVICEURL",function(t,e,o,r){var n=[],s=function(t){return e["delete"](r+t.id,JSON.parse(JSON.stringify(t))).then(function(){for(var e=0;e<n.length;e++)t.id==n[e].id&&n.splice(e,1)})},i=function(t){if(void 0==t.id)return t.id=n.length+1,n.push(t),e({method:"POST",url:r,data:JSON.parse(JSON.stringify(t))});for(var o=0;o<n.length;o++)if(t.id==n[o].id)return n[o]=t,e.put(r+t.id,JSON.parse(JSON.stringify(t)))},a=function(){return n};return{savePost:function(t){return i(t)},getPosts:function(){return a()},removePost:function(t){return s(t)},listPosts:function(t){var r=o.defer();return e.get(t).then(function(t){r.resolve(t.data),n=t.data}),r.promise}}}]),angular.module("postManagerApp").factory("AlertService",["$rootScope",function(t){var e=function(e){1==confirm(e)&&t.$emit("removePost")},o=function(t){alert(t)};return{confirmMessage:function(t){e(t)},alertMessage:function(t){o(t)}}}]),angular.module("postManagerApp").directive("searchModel",function(){return{restrict:"EA",transclude:!0,template:'<ng-transclude></ng-transclude><a id="search-btn" href="" ng-click="toggleSearch(true);"><i class="glyphicon glyphicon-search"</a>',link:function(t,e){var o=e.find("#search"),r=e.find("#search-btn");o.blur(function(){t.toggleSearch(!1)}),t.toggleSearch=function(t){1==t?(r.hide(),o.show().css({padding:"10px",border:"1px solid lightgrey"}).animate({width:"180px"},500)):o.animate({width:"0",padding:"0",border:"0"},500).hide(0,function(){r.show()})}}}});